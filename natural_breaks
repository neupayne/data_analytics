import matplotlib.pyplot as plt
import pandas as pd
import psycopg2 as ps
import numpy as np
import jenkspy
import csv

try:
   conn = ps.connect(host='192.168.20.232', port='5432', dbname='RDMS', user='webacc', password='+wb**!12_')

   cur = conn.cursor()

   cur.execute(
       'SELECT "rehexid", "nevermarri" FROM geoserver."rehex_Table" where nevermarri > 0 ')

   icerik = cur.fetchall()
   ##print(icerik)
   col_names = [cn[0] for cn in cur.description]

   df = pd.DataFrame(columns=col_names, data=icerik)
   numpymatrix = df.as_matrix()
   compsubway = numpymatrix[:,1]

   breaks_compsubway = jenkspy.jenks_breaks(compsubway, nb_class=100)

   csvfile = "C:/Users/deniz.saglam/Desktop/natural breaks value/nevermarri"
   with open(csvfile, "w") as output:
       writer = csv.writer(output, lineterminator='\n')
       for val in breaks_compsubway:
           writer.writerow(breaks_compsubway)

   print(breaks_compsubway)
   #print(len(breaks_compsubway))

except:
   print("Hata olustu")

finally:
   conn.close()

